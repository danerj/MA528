\documentclass{article}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{fullpage}


\makeatletter
\def\moverlay{\mathpalette\mov@rlay}
\def\mov@rlay#1#2{\leavevmode\vtop{%
   \baselineskip\z@skip \lineskiplimit-\maxdimen
   \ialign{\hfil$\m@th#1##$\hfil\cr#2\crcr}}}
\newcommand{\charfusion}[3][\mathord]{
    #1{\ifx#1\mathop\vphantom{#2}\fi
        \mathpalette\mov@rlay{#2\cr#3}
      }
    \ifx#1\mathop\expandafter\displaylimits\fi}
\makeatother

\newcommand{\cupdot}{\charfusion[\mathbin]{\cup}{\cdot}}
\newcommand{\bigcupdot}{\charfusion[\mathop]{\bigcup}{\cdot}}

\title{MA 528 Exercise Set 1}
\author{Dane Johnson}

\setlength\parindent{0pt}
\begin{document}
\maketitle

\section*{Chapter 2 Axioms of Probability}

\subsection*{Exercise 2.1}

Let $\Omega$ be a finite set. Show that the set of all subsets of $\Omega$, $2^\Omega$, is also
finite and that it is a $\sigma$-algebra.\\

Answer:\\

Claim: If $|\Omega| = n$ for some nonnegative integer $n$, $|2^\Omega| = 2^{|\Omega|}$.\\

Proof (Induction): If $\Omega = \emptyset$, $\emptyset$ is the only subset of $\Omega$ and $|2^\Omega| = 1 = 2^0 = 2^{|\Omega|}$. Assume the claim holds for a set of cardinality $n$, $n \geq 0$, and consider the case of $|\Omega| = n+1$. Select on element $\omega \in \Omega$ and consider all $A \subset \Omega$ such that $\omega \notin A$. By the inductive hypothesis there are $2^n$ such subsets of $\Omega$. For each of these subsets, we build a new subset of $\Omega$ by including $\omega$. In this way we find another $2^n$ subsets of $\Omega$. Since for any subset $A$ of $\Omega$, either $\omega \in A$ or $\omega \notin A$, conclude that $|2^\Omega| = 2\cdot 2^n = 2^{n+1} = 2^{|\Omega|}$. \\

By the claim above, if $\Omega$ is a finite set then $|2^\Omega| = 2^{|\Omega|} < +\infty$. \\

To show that $2^\Omega$ is a $\sigma$-algebra, check that $2^\Omega$ satisfies axioms (1), (2), and (4) from Definition 2.1.

\begin{enumerate}
\item Since $\emptyset \subseteq \Omega$ and $\Omega \subseteq \Omega$, $\emptyset,\Omega \in 2^\Omega$.

\item Suppose $A \in 2^\Omega$. Then $A \subseteq \Omega$ and $A^c = \{\omega \in \Omega : \omega \notin A\} \subseteq \Omega$. Therefore $A^c \in 2^\Omega$ as well.

\stepcounter{enumi}

\item Suppose $A_1, A_2, \dots$ is a countable sequence of events in $2^\Omega$. Since each $A_k$ is a subset of $\Omega$,

$$\bigcup_{k=1}^\infty A_k = \{\omega \in \Omega : \omega \in A_k \text{ for some } k \} \subseteq \Omega \implies \bigcup_{k=1}^\infty A_k \in 2^\Omega,$$
$$\bigcap_{k=1}^\infty A_k = \{\omega \in \Omega : \omega \in A_k \text{ for all } k \} \subseteq \Omega \implies \bigcap_{k=1}^\infty A_k \in 2^\Omega.$$
\end{enumerate}

\subsection*{Exercise 2.2}

Let $(G_\alpha)_{\alpha \in A}$ be an arbitrary family of $\sigma$-algebras defined on an abstract
space $\Omega$. Show that $H = \cap_{\alpha \in A} G_\alpha$ is also a $\sigma$-algebra. \\

Answer:

\begin{enumerate}
\item Since each $G_\alpha$ is a $\sigma$-algebra, $\emptyset, \Omega \in G_\alpha$ for each $\alpha \in A$. Thus $\emptyset, \Omega \in H$. 

\item Suppose $A \in H$. Then $A \in G_\alpha$ for each $\alpha$ so that $A^c \in G_\alpha$ for each $\alpha$. Thus $A^c \in H$. 

\stepcounter{enumi}

\item Suppose $A_1, A_2, \dots$ is a countable sequence of events in $H$. For each $\alpha \in A$, $A_1, A_2, \dots$ is a countable sequence of events in $G_\alpha$. This means

$$\bigcup_{k=1}^\infty A_k, \bigcap_{k=1}^\infty A_k \in G_\alpha \text{ for each } \alpha \in A \implies \bigcup_{k=1}^\infty A_k, \bigcap_{k=1}^\infty A_k \in H.$$
\end{enumerate}


\subsection*{Exercise 2.4}

Let $\mathcal{A}$ be a $\sigma$-algebra and $(A_n)_{n\geq 1}$ a sequence of events in $\mathcal{A}$. Show that

$$\liminf_{n\rightarrow \infty} A_n \in \mathcal{A}; \quad \limsup_{n\rightarrow \infty} A_n \in \mathcal{A}; \quad \text{and} \quad \liminf_{n\rightarrow \infty} A_n \subseteq \limsup_{n\rightarrow \infty} A_n.$$

Answer: Recall the definitions

$$
\liminf_{n\rightarrow \infty} A_n = \cup_{n=1}^\infty \cap_{m \geq n} A_m,
$$
$$
\limsup_{n\rightarrow \infty} A_n = \cap_{n=1}^\infty \cup_{m \geq n} A_m.
$$

For each positive integer $n$, $(A_m)_{m\geq n}$ is a countable sequence of events in $\mathcal{A}$. By the definition of a $\sigma$-algebra, this means both $\cap_{m\geq n} A_m$ and $\cup_{m\geq n} A_m$ belong to $\mathcal{A}$ as $\mathcal{A}$ is closed under countable intersections and unions. But then $(\cap_{m\geq n} A_m)_{n \geq 1}$ and $(\cup_{m\geq n} A_m)_{n\geq 1}$ are each countable sequences of events in $\mathcal{A}$ so that again by the definition of a $\sigma$-algebra

$$
\liminf_{n\rightarrow \infty} A_n = \cup_{n=1}^\infty \cap_{m \geq n} A_m \in \mathcal{A} \quad \text{and} \quad \limsup_{n\rightarrow \infty} A_n = \cap_{n=1}^\infty \cup_{m \geq n} A_m.
$$

Suppose $a \in \liminf_{n\rightarrow \infty} A_n$. Then there exists a positive integer $n$ such that $a \in \cap_{m\geq n} A_m$. Since $a \in A_m$ for every $m \geq n$, $a \in \cup_{i\geq k}^\infty A_i$ for each $k$ (no matter how large we choose $k$, there is an $m \geq n$ such that $m \geq k$ so that $a \in A_m \subseteq \cup_{i\geq k} A_i$). Thus $a \in \cap_{i=1}^\infty \cup_{k\geq i} A_k = \limsup_{n \rightarrow \infty} A_n$, which establishes $\liminf_{n\rightarrow \infty} A_n \subseteq \limsup_{n\rightarrow \infty} A_n$. 

\subsection*{Exercise 2.5} 

Let $(A_n)_{n \geq 1}$ be a sequence of sets. Show that

$$
\limsup_{n\rightarrow \infty} 1_{A_n} - \liminf_{n\rightarrow \infty} 1_{A_n}
= 1_{\limsup_n A_n \backslash \liminf_n A_n}.
$$

Answer: Assume that whenever we index in what follows, $n$ comes from the set of positive integers.\\

Lemma: For all $\omega \in \Omega$,

$$
\liminf_{n\rightarrow \infty} 1_{A_n}(\omega) = 1_{\liminf_n A_n},
$$
$$
\limsup_{n\rightarrow \infty} 1_{A_n}(\omega) = 1_{\limsup_n A_n}.
$$

Proof: Note that $1_{\cap_{n} B_n} = \inf_n 1_{B_n}$ and $1_{\cup_n B_n} = \sup_n 1_{B_n}$. This follows from,

\begin{align*}
1_{\cap_n B_n}(\omega) = 1 &\iff \omega \in \cap_n B_n \\
&\iff \forall n, \omega \in B_n \\
&\iff \forall n, 1_{B_n}(\omega) = 1 \\
&\iff \inf_n 1_{B_n}(\omega) = 1.
\end{align*}

\begin{align*}
1_{\cup_n B_n}(\omega) = 1 &\iff \omega \in \cup_n B_n \\
&\iff \exists n, \omega \in B_n \\
&\iff \exists n, 1_{B_n}(\omega) = 1 \\
&\iff \sup_n 1_{B_n}(\omega) = 1.
\end{align*}

With only minor changes to the above, we see that $1_{\cap_{m\geq n} B_m} = \inf_{m\geq n} 1_{B_m}$ and $1_{\cup_{m\geq n} B_m} = \sup_{m\geq n} 1_{B_m}$ as well. Therefore,

$$
1_{\liminf_n A_n} = 1_{\cup_n \cap_{m\geq n} A_m} = \sup_n 1_{\cap_{m\geq n} A_m} = \sup_n \inf_{m\geq n} 1_{A_m} = \liminf_{n\rightarrow \infty} A_n,
$$
$$
1_{\limsup_n A_n} = 1_{\cap_n \cup_{m\geq n} A_m} = \inf_n 1_{\cup_{m\geq n} A_m} = \inf_n \sup_{m\geq n} 1_{A_m} = \limsup_{n\rightarrow \infty} A_n.
$$

Lemma: For $A,B \subset \Omega$, $1_{A \backslash B} = 1_A - 1_{A\cap B}$. \\

Proof: For any $\omega \in \Omega$,

\begin{align*}
1_{A\backslash B}(\omega) = 1 &\iff \omega \in A, \omega \not\in B \\
& \iff 1_A(\omega) = 1 \text{ and } 1_{A \cap B}(\omega) = 0 \\
& \iff 1_A(\omega) - 1_{A\cap B}(\omega) = 1.
\end{align*}

Using the two lemmas and the result $\liminf_{n\rightarrow \infty} A_n \subseteq \limsup_{n\rightarrow \infty} A_n$ from Exercise 2.4,

\begin{align*}
\limsup_{n \rightarrow \infty} 1_{A_n} - \liminf_{n \rightarrow \infty} 1_{A_n} 
&=  1_{\limsup_n A_n} - 1_{\liminf_n A_n} \\
&= 1_{\limsup_{n} A_n} - 1_{\liminf_{n} A_n \cap \limsup_{n} A_n} \\
&= 1_{\limsup_{n} A_n \backslash \liminf_{n} A_n}
\end{align*}


\subsection*{Exercise 2.6}

Let $\mathcal{A}$ be a $\sigma$-algebra of subsets of $\Omega$ and let $B \in \mathcal{A}$. Show that $\mathcal{F} = \{A \cap B : A \in \mathcal{A}\}$ is a $\sigma$-algebra of subsets of $B$. Is it still true when $B$ is a
subset of $\Omega$ that does not belong to $\mathcal{A}$?\\

Answer: To prove that $\mathcal{F}\subseteq 2^B$ is a $\sigma$-algebra of subsets of $B$, verify axioms (1), (2), and (4) of Definition 2.1.

\begin{enumerate}
\item To prove that $\mathcal{F}$ is a $\sigma$-algebra of subsets of $B$, check that $\emptyset, B \in \mathcal{F}$ (no need to check $\Omega \in \mathcal{F}$). Since $\emptyset, B \in A$, $\emptyset = \emptyset\cap B \in F$ and $B = B\cap B \in \mathcal{F}$. 

\item Let $F \in \mathcal{F}$ with $F = A\cap B$ for some $A \in \mathcal{A}$. Since $A,B \in \mathcal{A}$, $F \in \mathcal{A}$ and so $B \backslash F = B \cap F^c \in \mathcal{A}$ as well. Since $F \subseteq B$, the complement of $F$ relative to $B$ is $F^c = B \backslash F =  (B\backslash F) \cap B \in \mathcal{F}$.

\stepcounter{enumi}

\item Let $(F_n)_{n\geq 1}$ be a sequence of sets in $\mathcal{F}$ with $F_n = A_n \cap B$ for $A_n \in \mathcal{A}$. Because $\mathcal{A}$ is closed under countable unions and intersections,

$$
\bigcup_{k=1}^\infty F_k = \bigcup_{k=1}^\infty (A_n \cap B) = \left(\bigcup_{k=1}^\infty A_n\right) \cap B \in \mathcal{F},
$$

$$
\bigcap_{k=1}^\infty F_k = \bigcap_{k=1}^\infty (A_n \cap B) = \left(\bigcap_{k=1}^\infty A_n\right) \cap B \in \mathcal{F}.
$$
\end{enumerate}

\subsection*{Exercise 2.7}

Let $f$ be a function mapping $\Omega$ to another space $E$ with a $\sigma$-algebra $\mathcal{E}$.
Let $\mathcal{A} = \{A \subset \Omega : \exists B \in \mathcal{E}, A = f^{-1}(B)\}$. Show that $\mathcal{A}$ is a
$\sigma$-algebra on $\Omega$. 

\begin{enumerate}

\item $\emptyset \in \mathcal{E}$ since $\mathcal{E}$ is a $\sigma$-algebra. To see that $f^{-1}(\emptyset) = \emptyset$ suppose instead $f^{-1}(\emptyset) = A \neq \emptyset$. This would mean there is $a \in A\subseteq \Omega$ such that $f(a) \in \emptyset$, contradicting the definition of $\emptyset$. Thus $\emptyset \in \mathcal{A}$. Also $\Omega = \emptyset^c = \Omega \backslash \emptyset \in \mathcal{A}$ by (2), which is proved below. 

\item Suppose $A \in \mathcal{A}$ with $A = f^{-1}(B)$. Then $A^c = (f^{-1}(B))^c = f^{-1}(B^c) \in \mathcal{A}$ since $B^c \in \mathcal{E}$ and 

$$
x \in (f^{-1}(B))^c \iff x \notin f^{-1}(B) \iff f(x) \notin B \iff f(x) \in B^c \iff x \in f^{-1}(B^c).
$$

\stepcounter{enumi}

\item Let $(A_n)_{n\geq 1}$ be a sequence of sets in $\mathcal{A}$ with $A_n = f^{-1}(B_n)$.

$$\bigcup_{k=1}^\infty A_k = \bigcup_{k=1}^\infty f^{-1}(B_k) = f^{-1}\left(\bigcup_{k=1}^\infty  B_k \right) \in \mathcal{A}
$$

as $\bigcup_{k=1}^\infty B_k \in \mathcal{E}$ and 

$$x \in f^{-1}\left(\bigcup_{k=1}^\infty  B_k \right)
\iff f(x) \in \bigcup_{k=1}^\infty  B_k
\iff \exists k, f(x) \in B_k
\iff \exists k, x \in f^{-1}(B_k)
\iff x \in \bigcup_{k=1}^\infty  f^{-1}(B_k).
$$

Using this result and the fact that $\mathcal{A}$ is closed under complement by (2), $\bigcap_{k=1}^\infty A_k \in \mathcal{A}$ as well. 
\end{enumerate}

\subsection*{Exercise 2.8}\

Let $f: \mathbb{R} \rightarrow \mathbb{R}$ be a continuous function, and let $\mathcal{A} = \{A \subseteq \mathbb{R} : \exists B \in \mathfrak{B}, A = f^{-1}(B)\}$ where $\mathfrak{B}$ are the Borel subsets of the range space $\mathbb{R}$. Show that $\mathcal{A}\subset \mathcal{B}$, the Borel subsets of the domain space $\mathbb{R}$. \\

Answer: \\

\subsection*{Exercise 2.15}

Let $\mathcal{A}$ be a $\sigma$-algebra on the space $\Omega$ and $P$ a probability defined on $(\Omega, \mathcal{A})$. Let $A_i \in \mathcal{A}$ be a sequence of events. Show that

$$
P\left(\bigcup_{i=1}^n A_i \right) \leq \sum_{i = 1}^n P(A_i) \quad \forall n,
$$

$$
P\left(\bigcup_{i=1}^\infty A_i \right) \leq \sum_{i = 1}^\infty P(A_i).
$$

Answer:\\

Prove the first inequality (the finite case) by induction. For only one set $A \in \mathcal{A}$ equality holds and thus also inequality. Assume that the inequality holds and consider a sequence $A_1, \dots , A_{n+1}$. Let $A_{n+1}' = A_{n+1} \backslash (A_1 \cup \dots \cup A_{n})$ for some $n \geq 1$. Then $A_{n+1}' \cap (A_1 \cup \dots A_n) = \emptyset$ and $A_{n+1}' \subseteq A_{n+1}$.

\begin{align*}
P\left(\bigcup_{i=1}^{n+1} A_i \right)
&= P\left(\left(\bigcup_{i=1}^n A_n \right) \cup A_{n+1}' \right) \\
&= \sum_{i = 1}^n P(A_i) + P(A_{n+1}') \\
&\leq \sum_{i = 1}^n P(A_i) + P(A_{n+1}) \\
&= \sum_{i = 1}^{n+1} P(A_i)
\end{align*}

To prove countable subadditiviy, let
\begin{align*}
E_1 &:= A_1 \\
E_2 &:= A_2 \backslash  E_1 \\
E_3 &:= A_3 \backslash (E_1 \cup E_2) \\
E_4 &:= A_4 \backslash (E_1 \cup E_2 \cup E_3) \\
&\vdots \\
E_n &:= A_n \backslash \left(\bigcup_{i=1}^{n-1} E_i \right)
&\vdots 
\end{align*}

The $E_i$ are disjoint with $\bigcupdot_{i=1}^\infty E_i= \bigcup_{i=1}^\infty A_i$. To see that these unions are equal, first note that $E_i \subseteq A_i$ for each $i$ so $\bigcupdot_{i=1}^\infty E_i \subseteq \bigcup_{i=1}^\infty A_i$. If $x \in \bigcup_{i=1}^\infty A_i$ we may choose by the Well-Ordering Principle the least index $i$ such that $x \in A_i$. Then $x \in A_i$ and $x \notin A_j$ for $j < i$. Thus $x \in E_i \subseteq \bigcupdot_{i=1}^\infty E_i$. Since $E_i \subset A_i$ for each $i$, $P(E_i) \leq P(A_i)$ for each $i$ and

$$
P\left(\bigcup_{i=1}^\infty A_i \right) = P(\left(\bigcupdot_{i=1}^\infty E_i \right) = \sum_{i=1}^\infty P(E_i) \leq \sum_{i=1}^\infty P(A_i).
$$

\subsection*{Exercise 2.17}

Suppose that $\Omega$ is an infinite set (countable or not), and let $\mathcal{A}$ be the
family of all subsets which are either finite or have a finite complement. Show
that $\mathcal{A}$ is an algebra, but not a $\sigma$- algebra. 

\begin{enumerate}
\item Both $\emptyset \in \mathcal{A}$ and $\Omega \in \mathcal{A}$ as $\Omega^c = \emptyset$ is finite.

\item Suppose $A \in \mathcal{A}$. If $A$ is finite, then $A^c \in \mathcal{A}$ since $(A^c)^c = A$. If $A$ is infinite, then $A^c$ must be finite so $A^c \in \mathcal{A}$. 

\item Suppose $A_1, \dots , A_n \in \mathcal{A}$. If all of the $A_i$ are finite, then the finite union of finite sets $\bigcup_{i=1}^n A_i$ is finite. If there is a set $A_k$, $1\leq k \leq n$ such that $A_k$ is infinite then $\bigcup_{i=1}^n A_i$ is not finite. However, $A_k^c$ must be finite and $(\bigcup_{i=1}^n A_i)^c = \bigcap_{i=1}^n A_i^c \subset A_k^c$. This shows that $(\bigcup_{i=1}^n A_i)^c$ is finite so $\bigcup_{i=1}^n A_i \in \mathcal{A}$. Since $\mathcal{A}$ is closed under complement and finite union, $\bigcap_{i=1}^n A_i \in \mathcal{A}$ as well. \\

Since $\mathcal{A}$ satisfies axioms (1),(2), and (3), $\mathcal{A}$ is an algebra. However $\mathcal{A}$ is not a $\sigma$-algebra since it fails axiom (4):

\item $\mathcal{A}$ is not necessarily closed under countable union. Either $\Omega$ is countably infinite or uncountable. 

\begin{itemize}
\item If $\Omega$ is countably infinite, we can list the elements of $\Omega = \{\omega_1, \omega_2, \dots \}$. Let $A_i = x_{2i}$ for each positive integer $i$. Then both $\bigcup_{i=1}^\infty A_i = \{x_2, x_4, \dots \}$ is infinite and $\left(\bigcup_{i=1}^\infty A_i\right)^c = \{x_1,x_3, \dots\}$ is infinite so $\bigcup_{i=1}^\infty A_i \notin \mathcal{A}$. 

\item If $\Omega$ is uncountable, let $(A_i)_{n\geq 1}$ be a sequence of pairwise disjoint singleton sets. Then $\bigcup_{i=1}^\infty A_i$ has countably infinitely many elements and $\left(\bigcup_{i=1}^\infty A_i\right)^c$ must be uncountable (since $\Omega$ is uncountable). Since neither of $\bigcup_{i=1}^\infty A_i$, $\left(\bigcup_{i=1}^\infty A_i\right)^c$ is finite, $\bigcup_{i=1}^\infty A_i \notin \mathcal{A}$
\end{itemize}

\end{enumerate}

\newpage
\section*{Chapter 3 Conditional Probability and Independence}

\subsection*{Exercise 3.1}

Show that if $A \cap B = \emptyset$, then $A$ and $B$ cannot be independent unless $P(A) = 0$ or $P(B) = 0$. \\

Answer: Unless one or both of $P(A), P(B)$ is zero, $P(A)P(B) \neq 0 = P(A\cap B) / P(B) = P(A \vert B)$, meaning that $A$ and $B$ are not independent.

\subsection*{Exercise 3.2} Let $P(C) > 0$. Show that $P(A \cup B \vert C) = P(A \vert C) + P(B \vert C) - P(A \cap B \vert C)$. \\

Answer:

\begin{align*}
P(A\cup B \vert C) &= \frac{P((A\cup B) \cap C)}{P(C)} \\
&= \frac{P((A\cap C) \cup (B \cap C)}{P(C)} \\
&= \frac{P(A \cap C) + P(B \cap C) - P((A\cap C) \cap (B \cap C)}{P(C)} \\
&= \frac{P(A\cap C)}{P(C)} + \frac{P(B\cap C)}{P(C)} - \frac{P((A\cap B) \cap C)}{P(C)} \\
&= P(A \vert B) + P(B \vert C) - P(A\cap B \vert C).
\end{align*}

\subsection*{Exercise 3.6}

Donated blood is screened for AIDS. Suppose the test has $99\%$ accuracy, and that one in ten thousand people in your age group are HIV positive. The test has a $5\%$ false positive rating, as well. Suppose the test screens you as
positive. What is the probability you have AIDS? \\

Answer: Let $A$ be the event that you have AIDS and $B$ the event that you test HIV Positive. The events $A, A^c$ are a finite partition of the probability space. By Baye's Theorem, the probability that you have AIDS given that you have tested positive is

$$
P(A \vert B) = \frac{P(A \cap B)}{P(B)}
= \frac{P(B \vert A)P(A)}{P(B \vert A)P(A) + P(B \vert A^c) P(A^c)}
= \frac{(.99)(.0001)}{(.99)(.0001) + (0.05)(.9999)} \approx 0.001976.
$$

\subsection*{Exercise 3.7}

Let $(A_n)_{n\geq 1}, (B_n)_{n\geq 1}$ with $A_n, B_n \in \mathcal{A}$ for each $n$, $A_n \rightarrow A$, $B_n \rightarrow B$, $P(B) > 0$, and $P(B_n) > 0$ for each $n$.

\begin{enumerate}
\item $\lim_{n \rightarrow \infty} P(A_n \vert B) = P(A \vert B)$,

\item $\lim_{n \rightarrow \infty} P(A \vert B_n) = P(A \vert B)$,

\item $\lim_{n \rightarrow \infty} P(A_n \vert B_n) = P(A \vert B)$.

\end{enumerate}

Answer: 

\begin{enumerate}
\item Since $A_n \rightarrow A$, $A_n \cap B \rightarrow A \cap B$. By Theorem 2.4, $\lim_{n\rightarrow \infty} P(A_n \cap B) = P(A\cap B)$.

$$
\lim_{n\rightarrow \infty} P(A_n \vert B) = \lim_{n\rightarrow \infty} \frac{P(A_n \cap B)}{P(B)} = \frac{P(A \cap B)}{P(B)}.
$$

\item Since $B_n \rightarrow B$, $A \cap B_n \rightarrow A \cap B$. By Theorem 2.4, $\lim_{n\rightarrow \infty} P(A \cap B_n) = P(A\cap B)$.

$$
\lim_{n\rightarrow \infty} P(A \vert B_n) = \lim_{n\rightarrow \infty} \frac{P(A \cap B_n)}{P(B_n)} = \frac{P(A \cap B)}{P(B)}.
$$

\item Since $A_n \rightarrow A, B_n \rightarrow B$, $A_n \cap B _n\rightarrow A \cap B$. By Theorem 2.4, $\lim_{n\rightarrow \infty} P(A_n \cap B_n) = P(A\cap B)$.

$$
\lim_{n\rightarrow \infty} P(A_n \vert B_n) = \lim_{n\rightarrow \infty} \frac{P(A_n \cap B_n)}{P(B_n)} = \frac{P(A \cap B)}{P(B)}.
$$
\end{enumerate}

\subsection*{Exercise 3.11}

(Polya’s Urn) An urn contains $r$ red balls and $b$ blue balls. A ball is chosen at random from the urn, its color is noted, and it is returned together with d more balls of the same color. This is repeated indefinitely. What is
the probability that

\begin{enumerate}
\item The second ball drawn is blue?

\item The first ball drawn is blue given that the second ball drawn is blue?

\end{enumerate}

Answer: Let $B_n$ be the event that the $n$th ball drawn is blue and $R_n$ the event that the $n$th ball drawn is red.

\begin{enumerate}
\item $P(B_2) = P(B_2 \vert B_1)P(B_1) + P(B_2 \vert R_1)P(R_1) = \frac{b+d}{b+r+d}\frac{b}{b+r} + \frac{b}{b+r+d}\frac{r}{b+r} = \frac{b}{b+r}\left(\frac{b+d+r}{b+r+d}\right) = \frac{b}{b+r}$.

\item
$
P(B_1 \vert B_2) = \frac{P(B_1 \cap B_2)}{P(B_2)}
= \frac{P(B_2 \vert B_1)P(B_1)}{P(B_2)}
= \frac{b+d}{b+r+d}\frac{b}{b+r}\frac{b+r}{b}
= \frac{b+d}{b+r+d}
$
\end{enumerate}

\subsection*{Exercise 3.12}

Consider the framework of Exercise 3.11. Let $B_n$ denote the event that the $n$th ball drawn is blue. Show that $P(B_n) = P(B_1)$ for all $n \geq 1$. \\

Answer: Prove $P(B_n) = P(B_1)$ for all $n\geq 1$ by induction. Exercise 3.11 showed $P(B_2) = P(B_1) = b/(b+r)$. Assume that $P(B_n) = P(B_1)$ for some $n \geq 1$. Let $b_n, r_n$ stand respectively for the number of blue and red balls in the urn during the $n$th draw.

\begin{align*}
P(B_{n+1}) &= P(B_{n+1} \vert B_n)P(B_n) + P(B_{n+1} \vert R_n) P(R_n) \\
&= \frac{b_n + d}{b_n + r_n + d}\frac{b_n}{b_n + r_n} + \frac{b_n}{b_n + r_n + d}\frac{r_n}{b_n + r_n} \\
&= \frac{b_n}{b_n + r_n}\left(\frac{b_n + d}{b_n +r_n + d} + \frac{r_n}{b_n +r_n + d}\right) \\
&= \frac{b_n}{b_n + r_n} \\
&= P(B_n) \\
&= P(B_1).
\end{align*}


\subsection*{Exercise 3.13}

Consider the framework of Exercise 3.11. Find the probability that the first ball is blue given that the $n$ subsequent drawn balls are all blue. Find
the limit of this probability as $n \rightarrow \infty$. 

Answer:

\begin{align*}
P(B_1 \vert B_2 \cap \dots \cap B_{n+1}) &= \frac{P(B_2 \cap \dots \cap B_{n+1} \vert B_1)P(B_1)}{P(B_2\cap \dots \cap B_{n+1})} \\
&= \frac{P(B_2 \cap \dots \cap B_{n+1} \vert B_1)P(B_1)}{P(B_2\cap \dots \cap B_{n+1} \vert B_1)P(B_1) + P(B_2\cap \dots \cap B_{n+1} \vert R_1)P(R_1)} \\
&= \frac{\frac{b+d}{b+r+d}\frac{b+2d}{b+r+2d} \dots \frac{b+nd}{b+r+nd}\frac{b}{b+r}}{\frac{b+d}{b+r+d}\frac{b+2d}{b+r+2d} \dots \frac{b+nd}{b+r+nd}\frac{b}{b+r} + \frac{b}{b+r+d}\frac{b+d}{b+2r+d} \dots \frac{b+(n-1)d}{b+r+nd}\frac{r}{b+r}} \\
&= \frac{(b+d)(b+2d)\dots (b + nd)b}{[(b+d)(b+2d)\dots (b + nd)b] + [b(b+d)(b+2d)\dots (b+(n-1)d)r]} \\
&= \frac{b+nd}{b+nd + r}\\
&= \frac{b+nd}{b+r + nd}.
\end{align*}

$$
\lim_{n\rightarrow \infty} P(B_1 \vert B_2 \cap \dots \cap B_{n+1}) = \lim_{n\rightarrow \infty} \frac{b+nd}{b+r + nd} = \lim_{n\rightarrow \infty} \frac{b/n+d}{b/n+r/n + d} = 1.
$$

\end{document}